import{c as b,r as i,j as e,B as L,b as Y,X as Z,e as ee,F as te,D as _,L as I,n as l,f as se}from"./index-B76BCRfw.js";import{T as ae,a as re,E as A,M as ie,B as D}from"./Elements-D2M9BIb3.js";import{S as le}from"./shield-check-DscC_xtE.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],oe=b("calendar",ne);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],O=b("check",ce);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],xe=b("file-braces",de);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],V=b("panels-top-left",me),H=()=>typeof window<"u"?window.electronAPI:void 0,pe=async(c,n)=>{const m=H();if(m!=null&&m.generateReport)return m.generateReport({projectId:c,format:n});throw new Error("Electron API unavailable: report generation requires SQLite backend.")},B=async c=>{const n=H();if(n!=null&&n.getReportPreview)return n.getReportPreview({projectId:c});throw new Error("Electron API unavailable: report preview requires SQLite backend.")},ue=[{id:"t1",name:"Executive Summary",icon:V,desc:"High-level overview for stakeholders."},{id:"t2",name:"Technical Findings",icon:te,desc:"Detailed remediation steps for developers."},{id:"t3",name:"Raw Data Export",icon:ae,desc:"Full issue set in structured CSV format."},{id:"t4",name:"API JSON Sync",icon:xe,desc:"Machine readable export for automation."}],be=({externalProjects:c,externalActiveId:n,onProjectSelect:m})=>{const[Q,W]=i.useState("t1"),[h,w]=i.useState(!1),[p,j]=i.useState(""),[v,X]=i.useState("pdf"),[q,g]=i.useState(!1),[f,k]=i.useState(""),[y,S]=i.useState(""),[C,E]=i.useState(""),[P,M]=i.useState("pdf"),[d,R]=i.useState(!1),[F,u]=i.useState(null),[z,T]=i.useState([]),a=i.useMemo(()=>c.find(t=>t.id===n)||c[0],[n,c]),N=i.useMemo(()=>c.filter(t=>t.name.toLowerCase().includes(p.toLowerCase())||t.client.toLowerCase().includes(p.toLowerCase())),[c,p]);i.useEffect(()=>{const t=localStorage.getItem("vanguardRecentEmails");if(t)try{const s=JSON.parse(t);Array.isArray(s)&&T(s.filter(o=>typeof o=="string"))}catch{}},[]);const G=i.useMemo(()=>{const t=new Map;return N.forEach(s=>{var r;const o=s.parentId||null;t.has(o)||t.set(o,[]),(r=t.get(o))==null||r.push(s)}),t},[N]),$=(t,s=0)=>(G.get(t)||[]).flatMap(r=>{const U=e.jsxs("button",{onClick:()=>m(r.id),className:`p-6 rounded-[2rem] border text-left transition-all group relative overflow-hidden ${n===r.id?"border-indigo-600 bg-white ring-1 ring-indigo-600 shadow-lg shadow-indigo-100":"border-slate-100 bg-slate-50/50 hover:border-slate-300 hover:bg-white hover:shadow-md"}`,style:{marginLeft:s?s*12:0},children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("span",{className:`text-[8px] font-black uppercase tracking-[0.2em] px-3 py-1 rounded-lg border ${r.status==="active"?"bg-emerald-50 text-emerald-600 border-emerald-100":"bg-slate-200 text-slate-600 border-slate-300"}`,children:r.status}),n===r.id&&e.jsx("div",{className:"bg-indigo-600 p-1.5 rounded-full shadow-lg shadow-indigo-200",children:e.jsx(O,{size:12,className:"text-white",strokeWidth:4})})]}),e.jsx("h4",{className:`font-black text-lg leading-tight mb-1 ${n===r.id?"text-indigo-700":"text-slate-800"}`,children:r.name}),e.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-widest",children:r.client}),e.jsxs("div",{className:"mt-8 pt-5 border-t border-slate-100/50 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-slate-600 font-black uppercase tracking-widest",children:[e.jsx(le,{size:14,className:"text-rose-500"}),e.jsx("span",{className:"tabular-nums",children:r.issueCount.critical+r.issueCount.high})," Findings"]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-[9px] text-slate-400 font-bold uppercase tracking-widest",children:[e.jsx(oe,{size:12}),r.lastUpdate]})]})]},r.id),K=$(r.id,s+1);return[U,...K]}),J=async t=>{if(!a){l("Please select a project first.","info");return}w(!0);try{const s=await pe(a.id,t);if(!s){l("Report generation canceled.","info"),w(!1);return}if("error"in s)throw new Error(s.error);l(`Report for ${a.name} generated.`,"success")}catch(s){console.error("Failed to generate report",s),l(s instanceof Error?s.message:"Failed to generate report.")}finally{w(!1)}},x=a?a.issueCount.critical+a.issueCount.high+a.issueCount.medium+a.issueCount.low:0;return e.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-700 pb-20",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-end justify-between gap-4",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:"text-3xl sm:text-4xl font-black text-slate-800 tracking-tight",children:"Deliverable Architect"}),e.jsx("p",{className:"text-slate-500 font-medium text-sm",children:"Compile and export security intelligence for strategic stakeholders."})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-8",children:[e.jsxs("section",{className:"bg-white p-6 sm:p-8 rounded-[2rem] border border-slate-200 shadow-sm transition-all hover:shadow-xl hover:shadow-indigo-100/5",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2.5 bg-indigo-50 rounded-xl text-indigo-600",children:e.jsx(L,{size:20})}),e.jsx("h3",{className:"font-black text-sm text-slate-800 uppercase tracking-widest",children:"1. Target Context Vault"})]}),e.jsxs("div",{className:"relative group w-full sm:min-w-[240px]",children:[e.jsx(Y,{className:`absolute left-4 top-1/2 -translate-y-1/2 transition-colors ${p?"text-indigo-500":"text-slate-300"}`,size:16}),e.jsx("input",{type:"text",placeholder:"Filter active engagements...",value:p,onChange:t=>j(t.target.value),className:"w-full pl-11 pr-10 py-3 bg-slate-50 border border-slate-100 rounded-2xl text-xs font-black outline-none focus:ring-4 focus:ring-indigo-500/10 focus:bg-white transition-all shadow-sm"}),p&&e.jsx("button",{onClick:()=>j(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-300 hover:text-rose-500",children:e.jsx(Z,{size:16})})]})]}),N.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 max-h-[360px] overflow-y-auto pr-3 custom-scrollbar p-1",children:$(null)}):e.jsxs("div",{className:"py-16 flex flex-col items-center justify-center text-center space-y-4 bg-slate-50/50 rounded-[2rem] border border-dashed border-slate-200",children:[e.jsx("div",{className:"w-20 h-20 rounded-[2rem] bg-white shadow-xl flex items-center justify-center text-slate-200",children:e.jsx(ee,{size:40})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-lg font-black text-slate-800",children:"No matching vaults found"}),e.jsx("p",{className:"text-sm text-slate-400 font-medium",children:"Verify your search term or initialize a new project from the sidebar."})]}),e.jsx("button",{onClick:()=>j(""),className:"text-[11px] font-black uppercase tracking-widest text-indigo-600 hover:underline",children:"Clear Search"})]})]}),e.jsxs("section",{className:"bg-white p-6 sm:p-8 rounded-[2rem] border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[e.jsx("div",{className:"p-2.5 bg-slate-50 rounded-xl text-slate-400",children:e.jsx(V,{size:20})}),e.jsx("h3",{className:"font-black text-sm text-slate-800 uppercase tracking-widest",children:"2. Deliverable Framework"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:ue.map(t=>{const s=t.icon,o=Q===t.id;return e.jsxs("button",{onClick:()=>W(t.id),className:`p-6 rounded-[1.75rem] border transition-all text-left flex flex-col gap-5 relative group overflow-hidden ${o?"bg-slate-900 border-slate-900 text-white shadow-2xl shadow-slate-200 scale-[1.02]":"bg-white border-slate-100 text-slate-600 hover:border-indigo-200 hover:shadow-lg"}`,children:[e.jsx("div",{className:`p-3 rounded-2xl w-fit transition-colors ${o?"bg-indigo-600 text-white":"bg-slate-50 text-indigo-600 group-hover:bg-indigo-50"}`,children:e.jsx(s,{size:24})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-black text-lg tracking-tight mb-2",children:t.name}),e.jsx("p",{className:`text-xs leading-relaxed font-medium ${o?"text-slate-400":"text-slate-500"}`,children:t.desc})]}),o&&e.jsx("div",{className:"absolute top-6 right-6 text-indigo-400",children:e.jsx(O,{size:24,strokeWidth:4})})]},t.id)})})]})]}),e.jsx("div",{className:"lg:col-span-4 space-y-8",children:a?e.jsxs("div",{className:"bg-white rounded-[3rem] border border-slate-200 p-10 shadow-2xl shadow-indigo-100/30 overflow-hidden relative sticky top-36",children:[e.jsxs("h3",{className:"text-xl font-black text-slate-800 mb-8 flex items-center gap-3 tracking-tighter",children:[e.jsx(_,{size:24,className:"text-indigo-600"}),"Export Manifest"]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-[10px] text-slate-400 font-black uppercase tracking-[0.4em]",children:"Target Scope"}),e.jsxs("div",{className:"p-1",children:[e.jsx("p",{className:"font-black text-xl text-slate-800 leading-tight tracking-tight",children:a.name}),e.jsx("p",{className:"text-sm text-indigo-600 font-black uppercase tracking-widest mt-1",children:a.client})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[e.jsxs("div",{className:"bg-slate-50 p-5 rounded-[1.75rem] border border-slate-100",children:[e.jsx("p",{className:"text-[9px] text-slate-400 font-black uppercase tracking-widest mb-1",children:"Issue Set"}),e.jsx("p",{className:"text-3xl font-black text-slate-800 tabular-nums",children:x})]}),e.jsxs("div",{className:"bg-slate-50 p-5 rounded-[1.75rem] border border-slate-100",children:[e.jsx("p",{className:"text-[9px] text-slate-400 font-black uppercase tracking-widest mb-1",children:"Artifacts"}),e.jsx("p",{className:"text-xl font-black text-slate-800 uppercase tracking-tight",children:"PDF/HTML/DOCX"})]})]}),e.jsxs("div",{className:"bg-slate-900 p-6 rounded-[2rem] border border-slate-800 shadow-inner",children:[e.jsx("p",{className:"text-[10px] text-slate-500 font-black uppercase tracking-widest mb-5",children:"Vulnerability Pulse"}),e.jsxs("div",{className:"flex h-3 gap-1 rounded-full overflow-hidden bg-white/5 mb-6",children:[e.jsx("div",{style:{width:`${x>0?a.issueCount.critical/x*100:0}%`},className:"bg-rose-500 shadow-[0_0_10px_rgba(239,68,68,0.5)]"}),e.jsx("div",{style:{width:`${x>0?a.issueCount.high/x*100:0}%`},className:"bg-orange-500"}),e.jsx("div",{style:{width:`${x>0?a.issueCount.medium/x*100:0}%`},className:"bg-amber-500"})]}),e.jsxs("div",{className:"flex justify-between items-center text-[10px] font-black text-slate-400 tracking-widest",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-rose-500"}),a.issueCount.critical," CRIT"]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-slate-400",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-orange-500"}),a.issueCount.high," HIGH"]})]})]})]}),e.jsxs("div",{className:"mt-10 space-y-3",children:[e.jsxs("div",{className:"bg-white border border-slate-200 rounded-[2rem] p-4",children:[e.jsx("p",{className:"text-[10px] text-slate-400 font-black uppercase tracking-widest mb-3",children:"Export Format"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:["pdf","docx","html"].map(t=>e.jsx("button",{onClick:()=>X(t),className:`py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all border ${v===t?"bg-indigo-600 text-white border-indigo-600 shadow-lg shadow-indigo-200":"bg-slate-50 text-slate-500 border-slate-200 hover:bg-white"}`,children:t},t))})]}),e.jsxs("button",{disabled:h,onClick:()=>J(v),className:`w-full py-6 rounded-[2rem] font-black text-xs uppercase tracking-[0.2em] transition-all shadow-2xl flex items-center justify-center gap-3 ${h?"bg-slate-100 text-slate-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700 text-white shadow-indigo-200 active:scale-95"}`,children:[h?e.jsx(I,{size:20,className:"animate-spin"}):e.jsx(_,{size:20}),h?"Generating...":`Generate ${v.toUpperCase()} Report`]}),e.jsxs("button",{onClick:()=>{a&&(S(`Project Report: ${a.name}`),M("pdf"),g(!0))},className:"w-full bg-slate-900 hover:bg-slate-800 text-white py-6 rounded-[2rem] font-black text-xs uppercase tracking-[0.2em] transition-all flex items-center justify-center gap-3",children:[e.jsx(re,{size:20}),"Send Report Email"]}),e.jsxs("button",{onClick:async()=>{if(!a){l("Please select a project first.","info");return}try{const t=await B(a.id);if(t.error){l(t.error);return}if(!t.html){l("Preview is empty.","info");return}const s=window.open("","_blank");if(!s){l("Popup blocked. Please allow popups for preview.","info");return}s.document.write(t.html),s.document.close()}catch(t){console.error("Preview failed",t),l("Failed to generate preview.")}},className:"w-full bg-white hover:bg-slate-50 text-slate-700 py-6 rounded-[2rem] font-black text-xs uppercase tracking-[0.2em] transition-all border border-slate-200 flex items-center justify-center gap-3",children:[e.jsx(A,{size:20}),"Live Preview"]}),e.jsxs("button",{onClick:async()=>{if(!a){l("Please select a project first.","info");return}try{const t=await B(a.id);if(t.error){l(t.error);return}if(!t.html){l("Preview is empty.","info");return}const s=window.open("","_blank");if(!s){l("Popup blocked. Please allow popups for preview.","info");return}s.document.write(t.html),s.document.close()}catch(t){console.error("Preview failed",t),l("Failed to generate preview.")}},className:"w-full bg-white hover:bg-slate-50 text-slate-700 py-6 rounded-[2rem] font-black text-xs uppercase tracking-[0.2em] transition-all border border-slate-200 flex items-center justify-center gap-3",children:[e.jsx(A,{size:20}),"Live Preview"]})]})]}):e.jsxs("div",{className:"bg-slate-50 border-2 border-dashed border-slate-200 rounded-[3.5rem] p-16 text-center text-slate-400 font-black text-sm uppercase tracking-widest flex flex-col items-center gap-6",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-white flex items-center justify-center shadow-sm",children:e.jsx(L,{size:32})}),"Select a project from the vault to configure manifest."]})})]}),e.jsx(ie,{isOpen:q,onClose:()=>{g(!1),u(null)},title:"Send Project Report",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-indigo-600 uppercase tracking-widest px-1",children:"Recipient Email"}),e.jsx("input",{type:"email",value:f,onChange:t=>k(t.target.value),list:"recent-project-emails",disabled:d,className:"w-full bg-slate-50 border border-slate-100 rounded-2xl px-5 py-4 text-sm font-bold outline-none focus:ring-4 focus:ring-indigo-500/10 focus:bg-white transition-all shadow-sm"}),e.jsx("datalist",{id:"recent-project-emails",children:z.map(t=>e.jsx("option",{value:t},t))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-indigo-600 uppercase tracking-widest px-1",children:"Subject"}),e.jsx("input",{type:"text",value:y,onChange:t=>S(t.target.value),disabled:d,className:"w-full bg-slate-50 border border-slate-100 rounded-2xl px-5 py-4 text-sm font-bold outline-none focus:ring-4 focus:ring-indigo-500/10 focus:bg-white transition-all shadow-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-indigo-600 uppercase tracking-widest px-1",children:"Format"}),e.jsxs("select",{value:P,onChange:t=>M(t.target.value),disabled:d,className:"w-full bg-slate-50 border border-slate-100 rounded-2xl px-5 py-4 text-sm font-bold text-slate-900 outline-none",children:[e.jsx("option",{value:"pdf",children:"PDF Attachment"}),e.jsx("option",{value:"html",children:"HTML Email"}),e.jsx("option",{value:"docx",children:"DOCX Attachment"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-indigo-600 uppercase tracking-widest px-1",children:"Message (optional)"}),e.jsx("textarea",{value:C,onChange:t=>E(t.target.value),disabled:d,className:"w-full min-h-[120px] bg-slate-50 border border-slate-100 rounded-2xl px-5 py-4 text-sm font-bold outline-none focus:ring-4 focus:ring-indigo-500/10 focus:bg-white transition-all shadow-sm"})]}),d&&e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black uppercase tracking-widest text-indigo-600",children:[e.jsx(I,{size:14,className:"animate-spin"}),"Sending reportâ€¦"]}),F&&e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-rose-500",children:F}),e.jsxs("div",{className:"flex gap-4 pt-2",children:[e.jsx(D,{variant:"secondary",onClick:()=>{g(!1),u(null)},className:"flex-1",children:"Cancel"}),e.jsx(D,{onClick:async()=>{if(a){if(!f.trim()){u("Recipient email is required.");return}try{R(!0),u(null);const t=await se({projectId:a.id,to:f.trim(),subject:y.trim(),message:C.trim(),format:P});if(t!=null&&t.error){u(t.error);return}const s=Array.from(new Set([f.trim(),...z])).filter(Boolean).slice(0,8);T(s),localStorage.setItem("vanguardRecentEmails",JSON.stringify(s)),g(!1),k(""),E("")}catch(t){console.error("Failed to send report email",t),u("Failed to send email. Check SMTP settings.")}finally{R(!1)}}},className:"flex-[2]",disabled:d,children:d?"Sending...":"Send Report"})]})]})})]})};export{be as default};
